<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Distributed password cracking system for security professionals"><meta name=author content=ZerkerEOD><link href=https://zerkereod.github.io/krakenhashes/0.15.31/admin-guide/resource-management/rules/ rel=canonical><link href=../wordlists/ rel=prev><link href=../storage/ rel=next><link rel=icon href=../../../assets/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.20"><title>Rule Management - KrakenHashes Documentation</title><link rel=stylesheet href=../../../assets/stylesheets/main.e53b48f4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../css/timeago.css><link rel=stylesheet href=../../../stylesheets/extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rules-management class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="KrakenHashes Documentation" class="md-header__button md-logo" aria-label="KrakenHashes Documentation" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> KrakenHashes Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Rule Management </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=red data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ZerkerEOD/krakenhashes title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ZerkerEOD/krakenhashes </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../getting-started/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../../user-guide/ class=md-tabs__link> User Guide </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> Admin Guide </a> </li> <li class=md-tabs__item> <a href=../../../agent-guide/ class=md-tabs__link> Agent Guide </a> </li> <li class=md-tabs__item> <a href=../../../deployment/ class=md-tabs__link> Deployment </a> </li> <li class=md-tabs__item> <a href=../../../developer/ class=md-tabs__link> Developer Guide </a> </li> <li class=md-tabs__item> <a href=../../../reference/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../../troubleshooting/potfile-issues/ class=md-tabs__link> Troubleshooting </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="KrakenHashes Documentation" class="md-nav__button md-logo" aria-label="KrakenHashes Documentation" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> KrakenHashes Documentation </label> <div class=md-nav__source> <a href=https://github.com/ZerkerEOD/krakenhashes title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ZerkerEOD/krakenhashes </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../getting-started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../user-guide/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Admin Guide </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Admin Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2 id=__nav_4_2_label tabindex> <span class=md-ellipsis> System Setup </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> System Setup </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../system-setup/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../system-setup/ssl-tls/ class=md-nav__link> <span class=md-ellipsis> SSL/TLS Setup </span> </a> </li> <li class=md-nav__item> <a href=../../system-setup/email/ class=md-nav__link> <span class=md-ellipsis> Email Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../system-setup/authentication/ class=md-nav__link> <span class=md-ellipsis> Authentication </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3 checked> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex> <span class=md-ellipsis> Resource Management </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=true> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Resource Management </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../binaries/ class=md-nav__link> <span class=md-ellipsis> Managing Binaries </span> </a> </li> <li class=md-nav__item> <a href=../wordlists/ class=md-nav__link> <span class=md-ellipsis> Wordlist Management </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Rule Management </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Rule Management </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#directory-structure class=md-nav__link> <span class=md-ellipsis> Directory Structure </span> </a> </li> <li class=md-nav__item> <a href=#rule-file-formats-and-best-practices class=md-nav__link> <span class=md-ellipsis> Rule File Formats and Best Practices </span> </a> <nav class=md-nav aria-label="Rule File Formats and Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hashcat-rules class=md-nav__link> <span class=md-ellipsis> Hashcat Rules </span> </a> </li> <li class=md-nav__item> <a href=#john-the-ripper-rules class=md-nav__link> <span class=md-ellipsis> John the Ripper Rules </span> </a> </li> <li class=md-nav__item> <a href=#custom-rules class=md-nav__link> <span class=md-ellipsis> Custom Rules </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rule-type-detection class=md-nav__link> <span class=md-ellipsis> Rule Type Detection </span> </a> </li> <li class=md-nav__item> <a href=#rule-splitting-for-large-files class=md-nav__link> <span class=md-ellipsis> Rule Splitting for Large Files </span> </a> <nav class=md-nav aria-label="Rule Splitting for Large Files"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#automatic-rule-splitting class=md-nav__link> <span class=md-ellipsis> Automatic Rule Splitting </span> </a> </li> <li class=md-nav__item> <a href=#how-rule-splitting-works class=md-nav__link> <span class=md-ellipsis> How Rule Splitting Works </span> </a> </li> <li class=md-nav__item> <a href=#manual-rule-splitting class=md-nav__link> <span class=md-ellipsis> Manual Rule Splitting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-considerations class=md-nav__link> <span class=md-ellipsis> Performance Considerations </span> </a> <nav class=md-nav aria-label="Performance Considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rule-complexity class=md-nav__link> <span class=md-ellipsis> Rule Complexity </span> </a> </li> <li class=md-nav__item> <a href=#optimization-tips class=md-nav__link> <span class=md-ellipsis> Optimization Tips </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-rule-sets-and-their-uses class=md-nav__link> <span class=md-ellipsis> Common Rule Sets and Their Uses </span> </a> <nav class=md-nav aria-label="Common Rule Sets and Their Uses"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-password-variations class=md-nav__link> <span class=md-ellipsis> Basic Password Variations </span> </a> </li> <li class=md-nav__item> <a href=#leetspeak-transformations class=md-nav__link> <span class=md-ellipsis> Leetspeak Transformations </span> </a> </li> <li class=md-nav__item> <a href=#corporate-passwords class=md-nav__link> <span class=md-ellipsis> Corporate Passwords </span> </a> </li> <li class=md-nav__item> <a href=#keyboard-patterns class=md-nav__link> <span class=md-ellipsis> Keyboard Patterns </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-custom-rules class=md-nav__link> <span class=md-ellipsis> Creating Custom Rules </span> </a> <nav class=md-nav aria-label="Creating Custom Rules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rule-development-workflow class=md-nav__link> <span class=md-ellipsis> Rule Development Workflow </span> </a> </li> <li class=md-nav__item> <a href=#example-creating-domain-specific-rules class=md-nav__link> <span class=md-ellipsis> Example: Creating Domain-Specific Rules </span> </a> </li> <li class=md-nav__item> <a href=#testing-custom-rules class=md-nav__link> <span class=md-ellipsis> Testing Custom Rules </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-management class=md-nav__link> <span class=md-ellipsis> File Management </span> </a> <nav class=md-nav aria-label="File Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#uploading-rules class=md-nav__link> <span class=md-ellipsis> Uploading Rules </span> </a> </li> <li class=md-nav__item> <a href=#automatic-processing class=md-nav__link> <span class=md-ellipsis> Automatic Processing </span> </a> </li> <li class=md-nav__item> <a href=#duplicate-handling class=md-nav__link> <span class=md-ellipsis> Duplicate Handling </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#organization class=md-nav__link> <span class=md-ellipsis> Organization </span> </a> </li> <li class=md-nav__item> <a href=#naming-conventions class=md-nav__link> <span class=md-ellipsis> Naming Conventions </span> </a> </li> <li class=md-nav__item> <a href=#maintenance class=md-nav__link> <span class=md-ellipsis> Maintenance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#monitoring-and-troubleshooting class=md-nav__link> <span class=md-ellipsis> Monitoring and Troubleshooting </span> </a> <nav class=md-nav aria-label="Monitoring and Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#import-status class=md-nav__link> <span class=md-ellipsis> Import Status </span> </a> </li> <li class=md-nav__item> <a href=#common-issues class=md-nav__link> <span class=md-ellipsis> Common Issues </span> </a> </li> <li class=md-nav__item> <a href=#performance-metrics class=md-nav__link> <span class=md-ellipsis> Performance Metrics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#security-considerations class=md-nav__link> <span class=md-ellipsis> Security Considerations </span> </a> </li> <li class=md-nav__item> <a href=#integration-with-jobs class=md-nav__link> <span class=md-ellipsis> Integration with Jobs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../storage/ class=md-nav__link> <span class=md-ellipsis> Storage Architecture </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex> <span class=md-ellipsis> Operations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../operations/users/ class=md-nav__link> <span class=md-ellipsis> User Management </span> </a> </li> <li class=md-nav__item> <a href=../../operations/clients/ class=md-nav__link> <span class=md-ellipsis> Client Management </span> </a> </li> <li class=md-nav__item> <a href=../../operations/agents/ class=md-nav__link> <span class=md-ellipsis> Agent Management </span> </a> </li> <li class=md-nav__item> <a href=../../operations/scheduling/ class=md-nav__link> <span class=md-ellipsis> Agent Scheduling </span> </a> </li> <li class=md-nav__item> <a href=../../operations/job-settings/ class=md-nav__link> <span class=md-ellipsis> Job Settings </span> </a> </li> <li class=md-nav__item> <a href=../../operations/potfile/ class=md-nav__link> <span class=md-ellipsis> Potfile Management </span> </a> </li> <li class=md-nav__item> <a href=../../operations/monitoring/ class=md-nav__link> <span class=md-ellipsis> System Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../operations/backup/ class=md-nav__link> <span class=md-ellipsis> Backup Procedures </span> </a> </li> <li class=md-nav__item> <a href=../../operations/data-retention/ class=md-nav__link> <span class=md-ellipsis> Data Retention </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../security/ class=md-nav__link> <span class=md-ellipsis> Security Guide </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex> <span class=md-ellipsis> Advanced </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Advanced </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../advanced/presets/ class=md-nav__link> <span class=md-ellipsis> Preset Jobs & Workflows </span> </a> </li> <li class=md-nav__item> <a href=../../advanced/job-priority/ class=md-nav__link> <span class=md-ellipsis> Job Priority </span> </a> </li> <li class=md-nav__item> <a href=../../advanced/chunking/ class=md-nav__link> <span class=md-ellipsis> Job Chunking System </span> </a> </li> <li class=md-nav__item> <a href=../../advanced/performance/ class=md-nav__link> <span class=md-ellipsis> Performance Tuning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../agent-guide/ class=md-nav__link> <span class=md-ellipsis> Agent Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../deployment/ class=md-nav__link> <span class=md-ellipsis> Deployment </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../developer/ class=md-nav__link> <span class=md-ellipsis> Developer Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../reference/ class=md-nav__link> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../troubleshooting/potfile-issues/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=rules-management>Rules Management<a class=headerlink href=#rules-management title="Permanent link">&para;</a></h1> <p>KrakenHashes provides comprehensive management of rule files used for password cracking operations. This document explains how the system handles rule files and provides best practices for administrators.</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>Rules are transformation patterns applied to wordlists during password cracking operations. They allow you to generate password variations without storing massive wordlists. For example, a single rule can transform "password" into "Password123!", "p@ssw0rd", and many other variations.</p> <p><img alt="Rule Management Interface" src=../../../assets/images/screenshots/rule_management.png> <em>The Rule Management interface displaying uploaded rule files with status, type, size, and rule count information. The interface provides filtering options and actions for managing Hashcat and John the Ripper rule files.</em></p> <h2 id=directory-structure>Directory Structure<a class=headerlink href=#directory-structure title="Permanent link">&para;</a></h2> <p>The system monitors the rules directory and automatically creates the following subdirectory structure:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>rules/
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>├── hashcat/       # Hashcat-compatible rules
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>├── john/          # John the Ripper rules
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>└── custom/        # User-created or modified rules
</span></code></pre></div> <h2 id=rule-file-formats-and-best-practices>Rule File Formats and Best Practices<a class=headerlink href=#rule-file-formats-and-best-practices title="Permanent link">&para;</a></h2> <h3 id=hashcat-rules>Hashcat Rules<a class=headerlink href=#hashcat-rules title="Permanent link">&para;</a></h3> <p>Hashcat rules use a simple syntax where each character represents an operation:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a># Example hashcat rules
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>:                    # Try the original word
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>l                    # Convert to lowercase
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>u                    # Convert to uppercase
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>c                    # Capitalize first letter, lowercase rest
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>$1                   # Append &#39;1&#39; to the word
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>^a                   # Prepend &#39;a&#39; to the word
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>sa@                  # Replace all &#39;a&#39; with &#39;@&#39;
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>$1$2$3               # Append &#39;123&#39;
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>c$!                  # Capitalize and append &#39;!&#39;
</span></code></pre></div> <p><strong>Best Practices for Hashcat Rules:</strong> - Use comments (lines starting with #) to document complex rules - Group related rules together - Test rules with <code>--stdout</code> before using in production - Keep rule files focused on specific transformation types</p> <h3 id=john-the-ripper-rules>John the Ripper Rules<a class=headerlink href=#john-the-ripper-rules title="Permanent link">&para;</a></h3> <p>John rules have a similar but slightly different syntax:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a># Example John the Ripper rules
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>:                    # Try the original word
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>[lL]                 # Convert to lowercase
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>[uU]                 # Convert to uppercase
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>[cC]                 # Capitalize
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>$[0-9]               # Append a digit
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>^[aA]                # Prepend &#39;a&#39; or &#39;A&#39;
</span></code></pre></div> <h3 id=custom-rules>Custom Rules<a class=headerlink href=#custom-rules title="Permanent link">&para;</a></h3> <p>Custom rules should follow either Hashcat or John syntax depending on your cracking engine.</p> <h2 id=rule-type-detection>Rule Type Detection<a class=headerlink href=#rule-type-detection title="Permanent link">&para;</a></h2> <p>The system automatically assigns a rule type based on the file path: - If the path contains "john" (case-insensitive), it's classified as John the Ripper - Otherwise, it's classified as Hashcat - Administrators can change the type after import if needed</p> <h2 id=rule-splitting-for-large-files>Rule Splitting for Large Files<a class=headerlink href=#rule-splitting-for-large-files title="Permanent link">&para;</a></h2> <p>KrakenHashes includes an intelligent rule splitting system for distributing work across multiple agents:</p> <h3 id=automatic-rule-splitting>Automatic Rule Splitting<a class=headerlink href=#automatic-rule-splitting title="Permanent link">&para;</a></h3> <p>When rule splitting is enabled, the system can automatically split large rule files:</p> <p><strong>Configuration Settings:</strong> - <code>rule_split_enabled</code>: Enable/disable automatic rule splitting - <code>rule_split_threshold</code>: Threshold ratio for triggering splits (default: 0.8) - <code>rule_split_min_rules</code>: Minimum number of rules before splitting (default: 10,000) - <code>rule_split_max_chunks</code>: Maximum number of chunks to create (default: 100)</p> <h3 id=how-rule-splitting-works>How Rule Splitting Works<a class=headerlink href=#how-rule-splitting-works title="Permanent link">&para;</a></h3> <ol> <li><strong>Detection</strong>: When a job uses a rule file with more rules than the threshold, splitting is triggered</li> <li><strong>Chunking</strong>: The rule file is divided into equal chunks based on available agents</li> <li><strong>Distribution</strong>: Each agent receives a chunk of rules to process</li> <li><strong>Cleanup</strong>: Temporary chunk files are removed after job completion</li> </ol> <h3 id=manual-rule-splitting>Manual Rule Splitting<a class=headerlink href=#manual-rule-splitting title="Permanent link">&para;</a></h3> <p>For optimal performance, you can pre-split large rule files:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Split a rule file into 10 parts</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>split<span class=w> </span>-n<span class=w> </span><span class=m>10</span><span class=w> </span>large_rules.rule<span class=w> </span>rules_part_
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># Split by number of lines (1000 rules per file)</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>split<span class=w> </span>-l<span class=w> </span><span class=m>1000</span><span class=w> </span>large_rules.rule<span class=w> </span>rules_chunk_
</span></code></pre></div> <h2 id=performance-considerations>Performance Considerations<a class=headerlink href=#performance-considerations title="Permanent link">&para;</a></h2> <h3 id=rule-complexity>Rule Complexity<a class=headerlink href=#rule-complexity title="Permanent link">&para;</a></h3> <p>Different rule types have varying performance impacts:</p> <ol> <li><strong>Simple Rules</strong> (minimal impact):</li> <li>Case changes (l, u, c)</li> <li> <p>Single character operations ($x, ^x)</p> </li> <li> <p><strong>Moderate Rules</strong> (noticeable impact):</p> </li> <li>Multiple substitutions (sa@sb$sc()</li> <li> <p>Positional operations</p> </li> <li> <p><strong>Complex Rules</strong> (significant impact):</p> </li> <li>Multiple operations per rule</li> <li>Conditional rules</li> <li>Memory operations</li> </ol> <h3 id=optimization-tips>Optimization Tips<a class=headerlink href=#optimization-tips title="Permanent link">&para;</a></h3> <ol> <li><strong>Order Rules by Frequency</strong>: Place most likely successful rules first</li> <li><strong>Avoid Redundancy</strong>: Remove duplicate or overlapping rules</li> <li><strong>Benchmark First</strong>: Test rule performance with small wordlists</li> <li><strong>Use Rule Splitting</strong>: For rules &gt;10,000 lines, enable splitting</li> <li><strong>Monitor Memory</strong>: Complex rules can increase memory usage</li> </ol> <h2 id=common-rule-sets-and-their-uses>Common Rule Sets and Their Uses<a class=headerlink href=#common-rule-sets-and-their-uses title="Permanent link">&para;</a></h2> <h3 id=basic-password-variations>Basic Password Variations<a class=headerlink href=#basic-password-variations title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a># basic_variations.rule
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>:                    # Original
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>c                    # Capitalize
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>u                    # Uppercase
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>l                    # Lowercase
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>c$1                  # Capitalize + append 1
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>c$!                  # Capitalize + append !
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>$2023                # Append year
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>$2024                # Append year
</span></code></pre></div> <h3 id=leetspeak-transformations>Leetspeak Transformations<a class=headerlink href=#leetspeak-transformations title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a># leetspeak.rule
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>sa@                  # a -&gt; @
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>se3                  # e -&gt; 3
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>si1                  # i -&gt; 1
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>so0                  # o -&gt; 0
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>ss$                  # s -&gt; $
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>sa@se3              # Multiple substitutions
</span></code></pre></div> <h3 id=corporate-passwords>Corporate Passwords<a class=headerlink href=#corporate-passwords title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a># corporate.rule
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>c$1$2$3              # Capitalize + 123
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>c$!$@$#              # Capitalize + special chars
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>$@company            # Append company name
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>^Company             # Prepend company name
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>c$2023               # Capitalize + year
</span></code></pre></div> <h3 id=keyboard-patterns>Keyboard Patterns<a class=headerlink href=#keyboard-patterns title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a># keyboard_patterns.rule
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>$!@#                 # Common keyboard pattern
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>$123                 # Sequential numbers
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>$qwe                 # Keyboard row
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>$!qaz                # Vertical keyboard pattern
</span></code></pre></div> <h2 id=creating-custom-rules>Creating Custom Rules<a class=headerlink href=#creating-custom-rules title="Permanent link">&para;</a></h2> <h3 id=rule-development-workflow>Rule Development Workflow<a class=headerlink href=#rule-development-workflow title="Permanent link">&para;</a></h3> <ol> <li><strong>Analyze Target Patterns</strong>: Study password patterns from previous cracks</li> <li><strong>Write Initial Rules</strong>: Create rules based on observed patterns</li> <li><strong>Test with Hashcat</strong>: Use <code>--stdout</code> to verify transformations</li> <li><strong>Refine and Optimize</strong>: Remove ineffective rules, add variations</li> <li><strong>Document</strong>: Add comments explaining rule purpose</li> </ol> <h3 id=example-creating-domain-specific-rules>Example: Creating Domain-Specific Rules<a class=headerlink href=#example-creating-domain-specific-rules title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># finance_sector.rule</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=c1># Common patterns in financial sector</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=nv>$2023</span><span class=w>                </span><span class=c1># Current year</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=nv>$Q1</span><span class=w>                  </span><span class=c1># Quarter notation</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=nv>$USD</span><span class=w>                 </span><span class=c1># Currency</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>^FIN<span class=w>                 </span><span class=c1># Department prefix</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>sa@s<span class=nv>$$</span><span class=w>               </span><span class=c1># Common substitutions</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>c<span class=nv>$123</span><span class=w>                </span><span class=c1># Compliance requirement</span>
</span></code></pre></div> <h3 id=testing-custom-rules>Testing Custom Rules<a class=headerlink href=#testing-custom-rules title="Permanent link">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># Test rules with sample wordlist</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>hashcat<span class=w> </span>--stdout<span class=w> </span>wordlist.txt<span class=w> </span>-r<span class=w> </span>custom.rule<span class=w> </span><span class=p>|</span><span class=w> </span>head<span class=w> </span>-20
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=c1># Count generated candidates</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>hashcat<span class=w> </span>--stdout<span class=w> </span>wordlist.txt<span class=w> </span>-r<span class=w> </span>custom.rule<span class=w> </span><span class=p>|</span><span class=w> </span>wc<span class=w> </span>-l
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=c1># Verify specific transformations</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=nb>echo</span><span class=w> </span><span class=s2>&quot;password&quot;</span><span class=w> </span><span class=p>|</span><span class=w> </span>hashcat<span class=w> </span>--stdout<span class=w> </span>-r<span class=w> </span>custom.rule
</span></code></pre></div> <h2 id=file-management>File Management<a class=headerlink href=#file-management title="Permanent link">&para;</a></h2> <h3 id=uploading-rules>Uploading Rules<a class=headerlink href=#uploading-rules title="Permanent link">&para;</a></h3> <p>When uploading rule files:</p> <ol> <li>Choose appropriate rule type (Hashcat/John/Custom)</li> <li>Add descriptive tags for organization</li> <li>Include documentation in description field</li> <li>For large files (&gt;10MB), upload is processed asynchronously</li> </ol> <h3 id=automatic-processing>Automatic Processing<a class=headerlink href=#automatic-processing title="Permanent link">&para;</a></h3> <p>The system automatically: - Calculates MD5 hash for integrity - Counts rules (excluding comments and empty lines) - Verifies file accessibility - Tags auto-imported files</p> <h3 id=duplicate-handling>Duplicate Handling<a class=headerlink href=#duplicate-handling title="Permanent link">&para;</a></h3> <ul> <li>Same filename + same content = Skip upload</li> <li>Same filename + different content = Update existing</li> <li>Different filename + same content = Create new entry</li> </ul> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <h3 id=organization>Organization<a class=headerlink href=#organization title="Permanent link">&para;</a></h3> <ol> <li><strong>Categorize by Purpose</strong>: Use subdirectories for different rule types</li> <li><strong>Version Control</strong>: Include version numbers in filenames</li> <li><strong>Documentation</strong>: Include README files explaining rule sets</li> </ol> <h3 id=naming-conventions>Naming Conventions<a class=headerlink href=#naming-conventions title="Permanent link">&para;</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a># Good naming examples
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>basic_english_v2.rule
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>corporate_2024Q1.rule
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>web_app_patterns.rule
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>finance_sector_specific.rule
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a># Avoid
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>rules1.txt
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>new.rule
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>test.rule
</span></code></pre></div> <h3 id=maintenance>Maintenance<a class=headerlink href=#maintenance title="Permanent link">&para;</a></h3> <ol> <li><strong>Regular Reviews</strong>: Audit rule effectiveness quarterly</li> <li><strong>Update Patterns</strong>: Add new patterns as they emerge</li> <li><strong>Remove Obsolete</strong>: Delete rules for outdated patterns</li> <li><strong>Benchmark Performance</strong>: Test rule speed on new hardware</li> </ol> <h2 id=monitoring-and-troubleshooting>Monitoring and Troubleshooting<a class=headerlink href=#monitoring-and-troubleshooting title="Permanent link">&para;</a></h2> <h3 id=import-status>Import Status<a class=headerlink href=#import-status title="Permanent link">&para;</a></h3> <p>Check rule import status through: - Admin dashboard for overview - Server logs for detailed processing info - Database <code>verification_status</code> field</p> <h3 id=common-issues>Common Issues<a class=headerlink href=#common-issues title="Permanent link">&para;</a></h3> <ol> <li><strong>Large File Processing</strong>: Files &gt;1GB may take time to verify</li> <li><strong>Rule Syntax Errors</strong>: Invalid rules are skipped during counting</li> <li><strong>File Access</strong>: Ensure proper permissions on rule directories</li> </ol> <h3 id=performance-metrics>Performance Metrics<a class=headerlink href=#performance-metrics title="Permanent link">&para;</a></h3> <p>Monitor rule performance: - Rules/second processing rate - Memory usage during rule application - Success rate (cracks per rule application)</p> <h2 id=security-considerations>Security Considerations<a class=headerlink href=#security-considerations title="Permanent link">&para;</a></h2> <ol> <li><strong>Access Control</strong>: Limit rule file access to authorized users</li> <li><strong>Validation</strong>: System validates rule syntax during import</li> <li><strong>Audit Trail</strong>: All rule modifications are logged</li> <li><strong>Sensitive Patterns</strong>: Avoid hardcoding sensitive data in rules</li> </ol> <h2 id=integration-with-jobs>Integration with Jobs<a class=headerlink href=#integration-with-jobs title="Permanent link">&para;</a></h2> <p>Rules are selected during job creation: 1. Browse available verified rules 2. Select appropriate rule for attack type 3. System handles rule distribution to agents 4. Progress tracking shows rules processed</p> <p>For optimal performance, match rule complexity to available computational resources and expected password patterns.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 24, 2025 13:51:10 UTC"><span class=timeago datetime=2025-08-24T13:51:10+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 24, 2025 13:51:10 UTC">2025-08-24</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="August 1, 2025 19:47:46 UTC"><span class=timeago datetime=2025-08-01T19:47:46+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="August 1, 2025 19:47:46 UTC">2025-08-01</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ZerkerEOD/krakenhashes target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/taafA9cSFV target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "header.autohide", "content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../../js/timeago.min.js></script> <script src=../../../js/timeago_mkdocs_material.js></script> <script src=../../../javascripts/extra.js></script> </body> </html>